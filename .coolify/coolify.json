{
  "name": "BleeCMS Enterprise",
  "description": "Enterprise-grade Korean CMS supporting 10,000+ concurrent users",
  "version": "1.0.0",
  "type": "docker-compose",
  "compose_file": ".coolify/docker-compose.yml",
  "build": {
    "type": "dockerfile",
    "dockerfile": "Dockerfile",
    "context": ".",
    "target": "runner",
    "args": {
      "NODE_ENV": "production"
    }
  },
  "deploy": {
    "replicas": 2,
    "update_config": {
      "parallelism": 1,
      "delay": "10s",
      "failure_action": "rollback"
    },
    "rollback_config": {
      "parallelism": 1,
      "delay": "10s"
    },
    "restart_policy": {
      "condition": "on-failure",
      "delay": "5s",
      "max_attempts": 3
    }
  },
  "environment": {
    "NODE_ENV": "production",
    "PORT": "3000"
  },
  "resources": {
    "limits": {
      "cpus": "2",
      "memory": "2048M"
    },
    "reservations": {
      "cpus": "0.5",
      "memory": "512M"
    }
  },
  "healthcheck": {
    "test": "curl -f http://localhost:3000/api/health?quick=true || exit 1",
    "interval": "30s",
    "timeout": "3s",
    "retries": 3,
    "start_period": "40s"
  },
  "networks": ["coolify"],
  "volumes": [
    {
      "type": "volume",
      "source": "uploads",
      "target": "/app/public/uploads"
    },
    {
      "type": "volume",
      "source": "plugins",
      "target": "/app/plugins"
    },
    {
      "type": "volume",
      "source": "logs",
      "target": "/app/logs"
    }
  ],
  "services": {
    "database": {
      "type": "postgresql",
      "version": "15",
      "required": true,
      "config": {
        "max_connections": 200,
        "shared_buffers": "256MB",
        "effective_cache_size": "1GB",
        "maintenance_work_mem": "128MB",
        "checkpoint_completion_target": 0.9,
        "wal_buffers": "16MB",
        "default_statistics_target": 100,
        "random_page_cost": 1.1,
        "effective_io_concurrency": 200,
        "work_mem": "4MB",
        "min_wal_size": "1GB",
        "max_wal_size": "4GB"
      }
    },
    "redis": {
      "type": "redis",
      "version": "7",
      "required": true,
      "cluster": true,
      "nodes": 3,
      "config": {
        "maxmemory": "512mb",
        "maxmemory-policy": "allkeys-lru",
        "appendonly": "yes",
        "appendfsync": "everysec"
      }
    }
  },
  "monitoring": {
    "enabled": true,
    "prometheus": {
      "enabled": true,
      "port": 9090,
      "path": "/metrics"
    },
    "logs": {
      "driver": "json-file",
      "options": {
        "max-size": "10m",
        "max-file": "3"
      }
    }
  },
  "backup": {
    "enabled": true,
    "schedule": "0 2 * * *",
    "retention": 7,
    "targets": ["database", "uploads", "plugins"]
  },
  "scaling": {
    "auto": true,
    "min_replicas": 2,
    "max_replicas": 10,
    "metrics": {
      "cpu_threshold": 70,
      "memory_threshold": 80,
      "requests_per_second": 1000
    }
  },
  "security": {
    "ssl": {
      "enabled": true,
      "auto_renew": true,
      "provider": "letsencrypt"
    },
    "firewall": {
      "enabled": true,
      "allowed_ips": [],
      "rate_limiting": {
        "enabled": true,
        "requests_per_minute": 100
      }
    }
  },
  "notifications": {
    "slack": {
      "enabled": false,
      "webhook_url": "",
      "events": ["deploy", "error", "scale"]
    },
    "email": {
      "enabled": false,
      "recipients": [],
      "events": ["deploy", "error"]
    }
  },
  "hooks": {
    "pre_build": [],
    "post_build": ["npm run postinstall"],
    "pre_deploy": ["npm run migrate:deploy"],
    "post_deploy": ["npm run seed:production"],
    "pre_rollback": [],
    "post_rollback": []
  }
}